/*! 
 Build based on gin-vue-admin 
 Time : 1658720170000 */
var e=(e,a,l)=>new Promise(((t,o)=>{var i=e=>{try{s(l.next(e))}catch(a){o(a)}},u=e=>{try{s(l.throw(e))}catch(a){o(a)}},s=e=>e.done?t(e.value):Promise.resolve(e.value).then(i,u);s((l=l.apply(e,a)).next())}));import{s as a,r as l,b as t,o,c as i,e as u,d as s,w as r,t as n,y as d,h as m,i as c}from"../gva/gin-vue-admin-index.1658720170000.js";import{W as p}from"./gin-vue-admin-warningBar.1658720170000.js";import{f as v}from"./gin-vue-admin-format.1658720170000.js";import"./gin-vue-admin-date.1658720170000.js";import"./gin-vue-admin-dictionary.1658720170000.js";import"./gin-vue-admin-sysDictionary.1658720170000.js";const f=e=>a({url:"/customer/customer",method:"post",data:e}),g={class:"gva-table-box"},h={class:"gva-btn-list"},y=m("新增"),b=m("变更"),w=s("p",null,"确定要删除吗？",-1),k={style:{"text-align":"right","margin-top":"8px"}},C=m("取消"),_=m("确定"),z=m("删除"),V={class:"gva-pagination"},D={class:"dialog-footer"},x=m("取 消"),j=m("确 定"),I={name:"Customer"},P=Object.assign(I,{setup(m){const I=l({customerName:"",customerPhoneData:""}),P=l(1),U=l(0),N=l(10),S=l([]),A=e=>{N.value=e,L()},B=e=>{P.value=e,L()},L=()=>e(this,null,(function*(){const e=yield(l={page:P.value,pageSize:N.value},a({url:"/customer/customerList",method:"get",params:l}));var l;0===e.code&&(S.value=e.data.list,U.value=e.data.total,P.value=e.data.page,N.value=e.data.pageSize)}));L();const O=l(!1),T=l(""),W=l=>e(this,null,(function*(){const e=yield(t={ID:l.ID},a({url:"/customer/customer",method:"get",params:t}));var t;T.value="update",0===e.code&&(I.value=e.data.customer,O.value=!0)})),q=()=>{O.value=!1,I.value={customerName:"",customerPhoneData:""}},E=l=>e(this,null,(function*(){l.visible=!1;var e;0===(yield(e={ID:l.ID},a({url:"/customer/customer",method:"delete",data:e}))).code&&(c({type:"success",message:"删除成功"}),1===S.value.length&&P.value>1&&P.value--,L())})),F=()=>e(this,null,(function*(){let e;switch(T.value){case"create":default:e=yield f(I.value);break;case"update":e=yield(l=I.value,a({url:"/customer/customer",method:"put",data:l}))}var l;0===e.code&&(q(),L())})),G=()=>{T.value="create",O.value=!0};return(e,a)=>{const l=t("el-button"),m=t("el-table-column"),c=t("el-popover"),f=t("el-table"),L=t("el-pagination"),T=t("el-input"),H=t("el-form-item"),J=t("el-form"),K=t("el-dialog");return o(),i("div",null,[u(p,{title:"在资源权限中将此角色的资源权限清空 或者不包含创建者的角色 即可屏蔽此客户资源的显示"}),s("div",g,[s("div",h,[u(l,{size:"small",type:"primary",icon:"plus",onClick:G},{default:r((()=>[y])),_:1})]),u(f,{ref:"multipleTable",data:S.value,style:{width:"100%"},"tooltip-effect":"dark","row-key":"ID"},{default:r((()=>[u(m,{type:"selection",width:"55"}),u(m,{align:"left",label:"接入日期",width:"180"},{default:r((e=>[s("span",null,n(d(v)(e.row.CreatedAt)),1)])),_:1}),u(m,{align:"left",label:"姓名",prop:"customerName",width:"120"}),u(m,{align:"left",label:"电话",prop:"customerPhoneData",width:"120"}),u(m,{align:"left",label:"接入人ID",prop:"sysUserId",width:"120"}),u(m,{align:"left",label:"按钮组","min-width":"160"},{default:r((e=>[u(l,{size:"small",type:"primary",link:"",icon:"edit",onClick:a=>W(e.row)},{default:r((()=>[b])),_:2},1032,["onClick"]),u(c,{modelValue:e.row.visible,"onUpdate:modelValue":a=>e.row.visible=a,placement:"top",width:"160"},{reference:r((()=>[u(l,{type:"primary",link:"",icon:"delete",size:"small",onClick:a=>e.row.visible=!0},{default:r((()=>[z])),_:2},1032,["onClick"])])),default:r((()=>[w,s("div",k,[u(l,{size:"small",type:"primary",link:"",onClick:a=>e.row.visible=!1},{default:r((()=>[C])),_:2},1032,["onClick"]),u(l,{type:"primary",size:"small",onClick:a=>E(e.row)},{default:r((()=>[_])),_:2},1032,["onClick"])])])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:1})])),_:1},8,["data"]),s("div",V,[u(L,{"current-page":P.value,"page-size":N.value,"page-sizes":[10,30,50,100],total:U.value,layout:"total, sizes, prev, pager, next, jumper",onCurrentChange:B,onSizeChange:A},null,8,["current-page","page-size","total"])])]),u(K,{modelValue:O.value,"onUpdate:modelValue":a[2]||(a[2]=e=>O.value=e),"before-close":q,title:"客户"},{footer:r((()=>[s("div",D,[u(l,{size:"small",onClick:q},{default:r((()=>[x])),_:1}),u(l,{size:"small",type:"primary",onClick:F},{default:r((()=>[j])),_:1})])])),default:r((()=>[u(J,{inline:!0,model:I.value,"label-width":"80px"},{default:r((()=>[u(H,{label:"客户名"},{default:r((()=>[u(T,{modelValue:I.value.customerName,"onUpdate:modelValue":a[0]||(a[0]=e=>I.value.customerName=e),autocomplete:"off"},null,8,["modelValue"])])),_:1}),u(H,{label:"客户电话"},{default:r((()=>[u(T,{modelValue:I.value.customerPhoneData,"onUpdate:modelValue":a[1]||(a[1]=e=>I.value.customerPhoneData=e),autocomplete:"off"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"])])}}});export{P as default};
